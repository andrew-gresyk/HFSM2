name: CMake

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  build:
    runs-on: ${{ matrix.PLATFORM.OS }}

    env:
      CC: ${{ matrix.PLATFORM.CC }}
      CXX: ${{ matrix.PLATFORM.CXX }}

    strategy:
      matrix:
        PLATFORM:
          - {
              OS: ubuntu-latest,
              CC: gcc,
              CXX: g++
            }
          - {
              OS: ubuntu-latest,
              CC: clang,
              CXX: clang++
            }
          - {
              OS: macos-latest,
              CC: clang,
              CXX: clang++
            }

        PATH: 
          - ''
          - /examples/advanced_event_handling
          - /examples/basic_audio_player
          - /examples/basic_traffic_light
          - /examples/calculator
          - /examples/debug_logger_interface
          - /examples/snippets

        BUILD_CONFIG: [ Release, Debug ]

      fail-fast: false

    steps:
    - uses: actions/checkout@v2

    - run: cd ${{github.workspace}}${{matrix.PATH}}

    - name: Configure
      run: cmake -B ./build -DCMAKE_BUILD_TYPE=${{ matrix.BUILD_CONFIG }}

    - name: Build
      run: cmake --build ./build --config ${{ matrix.BUILD_CONFIG }}
